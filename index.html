<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HRì—…ë¬´ ì¢…í•© í¬íƒˆ</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        :root {
            --hr-primary: #0043ce; 
            --hr-primary-hover: #002d9c;
            --hr-bg-main: #f0f2f6; 
            --hr-card-bg: #ffffff;
            --hr-border: #dde1e6;
            --text-main: #161616;
            --text-sub: #525252;
            --text-mute: #8d8d8d;
            --accent: #ff832b; /* ì¶”ì²œ ë§›ì§‘ ê°•ì¡° ì»¬ëŸ¬ */
        }

        body { 
            margin: 0; 
            font-family: "Pretendard Variable", Pretendard, -apple-system, sans-serif; 
            color: var(--text-main); 
            -webkit-font-smoothing: antialiased;
            background-color: var(--hr-bg-main);
            background-image: 
                linear-gradient(to bottom, #002d9c 0%, #0043ce 300px, transparent 300px),
                radial-gradient(#c1c7cd 1px, transparent 1px);
            background-size: 100% 100%, 20px 20px;
            background-attachment: fixed;
        }

        .wrap { max-width: 1400px; margin: 0 auto; padding: 30px 20px; }
        
        header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 30px; padding: 20px 30px;
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(5px);
            border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-area { display: flex; align-items: center; gap: 15px; }
        .logo-box { 
            width: 44px; height: 44px; background: #ffffff; color: var(--hr-primary); 
            display: flex; align-items: center; justify-content: center; 
            border-radius: 8px; font-weight: 900; font-size: 20px; 
        }
        .logo-text h1 { margin: 0; font-size: 22px; font-weight: 800; color: #ffffff; }
        .logo-text p { margin: 2px 0 0; font-size: 11px; color: rgba(255,255,255,0.8); text-transform: uppercase; }
        
        .header-info { text-align: right; color: #ffffff; }
        #liveClock { font-weight: 800; font-family: 'JetBrains Mono', monospace; font-size: 18px; display: block; }

        .grid-main { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; }

        .card { 
            background: var(--hr-card-bg); border-radius: 10px; padding: 24px; 
            border: 1px solid var(--hr-border); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }
        .card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1); }

        .card-title { 
            display: flex; align-items: center; gap: 8px; 
            font-weight: 700; font-size: 16px; margin-bottom: 18px; 
            color: #161616; padding-left: 10px; border-left: 4px solid var(--hr-primary);
        }
        
        .link-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 8px; }
        .link-item { 
            display: flex; align-items: center; justify-content: space-between;
            padding: 12px 15px; background: #f4f7fb; border-radius: 6px; 
            text-decoration: none; color: #393939; font-size: 14px; transition: 0.2s;
        }
        .link-item:hover { background: var(--hr-primary); color: white; }

        .search-form { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .full-col { grid-column: span 2; }
        .form-group label { font-size: 11px; font-weight: 700; color: var(--text-mute); margin-bottom: 4px; display: block; }
        
        .input-box { 
            width: 100%; box-sizing: border-box; padding: 10px; 
            border: 1px solid #ced4da; border-radius: 6px; font-size: 13px; outline: none;
        }
        .input-box:focus { border-color: var(--hr-primary); }

        .btn-search { 
            grid-column: span 2; background: var(--hr-primary); color: white; border: none; padding: 12px; 
            border-radius: 6px; cursor: pointer; font-weight: 700; font-size: 14px; margin-top: 10px;
        }
        .btn-search:hover { background: var(--hr-primary-hover); }

        /* ë§›ì§‘ DB ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .db-section { grid-column: span 3; }
        .db-wrapper { display: flex; gap: 20px; }
        .db-form-side { width: 300px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #eee; }
        .db-list-side { flex: 1; }
        .btn-add-db { width: 100%; background: var(--accent); color: white; border: none; padding: 10px; border-radius: 6px; font-weight: 700; cursor: pointer; margin-top: 10px; }
        
        .fav-table { width: 100%; border-collapse: collapse; font-size: 13px; }
        .fav-table th { background: #e8eef9; padding: 12px; text-align: left; border-bottom: 2px solid var(--hr-border); }
        .fav-table td { padding: 10px 12px; border-bottom: 1px solid #edf2f7; }
        
        .btn-mini { padding: 5px 10px; border-radius: 4px; border: none; cursor: pointer; font-size: 11px; font-weight: 600; }
        .btn-go { background: var(--hr-primary); color: white; margin-right: 5px; }
        .btn-del { background: #fa4d56; color: white; }

        .asset-section { grid-column: span 3; }
        .file-upload-zone { 
            border: 2px dashed #cbd5e1; padding: 20px; border-radius: 10px; 
            display: flex; align-items: center; justify-content: center; gap: 15px; background: #f8f9fa;
        }
        
        #assetTable table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 13px; }
        #assetTable th { background: #e8eef9; color: var(--hr-primary); padding: 12px; border-bottom: 2px solid var(--hr-border); text-align: left; }
        #assetTable td { padding: 10px 12px; border-bottom: 1px solid #edf2f7; }
    </style>
</head>
<body>
    <div class="wrap">
        <header>
            <div class="logo-area">
                <div class="logo-box">HR</div>
                <div class="logo-text">
                    <h1>HRì—…ë¬´ ì¢…í•© í¬íƒˆ</h1>
                    <p>Corporate Administration System</p>
                </div>
            </div>
            <div class="header-info">
                <span class="today-date" id="datePart"></span>
                <span id="liveClock">00:00:00</span>
            </div>
        </header>

        <main class="grid-main">
            <div class="card">
                <div class="card-title">ğŸ›’ ë¹„í’ˆ</div>
                <div class="link-list">
                    <a href="https://biz.coupang.com" target="_blank" class="link-item"><span>ì¿ íŒ¡</span></a>
                    <a href="https://www.gmarket.co.kr" target="_blank" class="link-item"><span>Gë§ˆì¼“</span></a>
                    <a href="https://www.cofm.co.kr/" target="_blank" class="link-item"><span>ì»¤í”¼ëª°</span></a>
                    <a href="https://www.ssg.com/" target="_blank" class="link-item"><span>SSG</span></a>
                </div>
            </div>

            <div class="card">
                <div class="card-title">âœˆï¸ ì¶œì¥ ì§€ì›</div>
                <div class="link-list">
                    <a href="https://www.google.com/travel/flights" target="_blank" class="link-item"><span>ì „ì„¸ê³„ í•­ê³µí¸</span></a>
                    <a href="https://www.hotels.com/" target="_blank" class="link-item"><span>í˜¸í…”ìŠ¤ë‹·ì»´</span></a>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ğŸ´ íŒ€/ë¶€ì„œ íšŒì‹</div>
                <div class="search-form">
                    <div class="form-group full-col">
                        <label>íšŒì‹ ì§€ì—­</label>
                        <input type="text" id="dinnerArea" class="input-box" placeholder="ì˜ˆ: ê°•ë‚¨ì—­, íŒêµ">
                    </div>
                    <div class="form-group">
                        <label>ì˜ˆìƒ ì¸ì›</label>
                        <input type="number" id="dinnerPeople" class="input-box" placeholder="ëª…">
                    </div>
                    <div class="form-group">
                        <label>ì¸ë‹¹ ì˜ˆì‚°</label>
                        <input type="text" id="dinnerBudget" class="input-box" placeholder="ì˜ˆ: 50000">
                    </div>
                    <div class="form-group full-col">
                        <label>ì„ í˜¸ ë©”ë‰´/ì¢…ë¥˜</label>
                        <select id="dinnerType" class="input-box">
                            <option value="ê³ ê¸°ì§‘">ê³ ê¸°</option>
                            <option value="ì¤‘ì‹ë‹¹">ì¤‘ì‹</option>
                            <option value="ì¼ì‹ë‹¹">ì¼ì‹</option>
                            <option value="í•œì‹ ë§›ì§‘">í•œì‹</option>
                            <option value="ì´ìì¹´ì•¼">ì´ìì¹´ì•¼</option>
                            <option value="ìƒ¤ë¸Œìƒ¤ë¸Œ">ìƒ¤ë¸Œìƒ¤ë¸Œ</option>
                            <option value="í•œì •ì‹">í•œì •ì‹</option>
                        </select>
                    </div>
                    <div class="form-group full-col">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="dinnerRoom"> <span style="font-size: 13px;">ğŸšª ë£¸ ìš°ì„ ê²€ìƒ‰</span>
                        </label>
                    </div>
                    <button class="btn-search" onclick="searchDinner()">ìŒì‹ì  ì°¾ê¸°</button>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ğŸ¢ ì‚¬ë‚´ ê³µì‹ í–‰ì‚¬</div>
                <div class="search-form">
                    <div class="form-group full-col">
                        <label>í–‰ì‚¬ ì˜ˆì • ì§€ì—­</label>
                        <input type="text" id="eventArea" class="input-box" placeholder="ì˜ˆ: ê°•ë‚¨ì—­, íŒêµ">
                    </div>
                    <div class="form-group full-col">
                        <label>ì°¸ì—¬ ì¸ì›</label>
                        <input type="number" id="eventPeople" class="input-box" placeholder="ìˆ«ìë§Œ ì…ë ¥ (ì˜ˆ: 30)">
                    </div>
                    <div class="form-group full-col">
                        <label>í–‰ì‚¬ ìœ í˜•</label>
                        <select id="eventType" class="input-box">
                            <option value="ì„¸ë¯¸ë‚˜ì‹¤ ëŒ€ê´€">ì„¸ë¯¸ë‚˜</option>
                            <option value="ì›Œí¬ìˆ ì¥ì†Œ">ì›Œí¬ìˆ</option>
                        </select>
                    </div>
                    <button class="btn-search" onclick="searchEvent()" style="background: #393939; margin-top: 20px;">ê³µì‹ í–‰ì‚¬ ì¥ì†Œ ê²€ìƒ‰</button>
                </div>
            </div>

            <div class="card">
                <div class="card-title">ğŸ“‹ í–‰ì •/ì‚¬íšŒë³´í—˜</div>
                <div class="link-list">
                    <a href="https://www.4insure.or.kr" target="_blank" class="link-item"><span>4ëŒ€ì‚¬íšŒë³´í—˜ ì—°ê³„ì„¼í„°</span></a>
                    <a href="https://www.nps.or.kr" target="_blank" class="link-item"><span>êµ­ë¯¼ì—°ê¸ˆê³µë‹¨</span></a>
                    <a href="https://total.comwel.or.kr/" target="_blank" class="link-item"><span>ê³ ìš©ë³´í—˜ì‹œìŠ¤í…œ</span></a>
                    <a href="https://www.nhis.or.kr/nhis/index.do" target="_blank" class="link-item"><span>ê±´ê°•ë³´í—˜</span></a>
                </div>
            </div>

            <div class="card db-section">
                <div class="card-title">â­ ìš°ë¦¬ íŒ€ ì¶”ì²œ ë§›ì§‘/ì¥ì†Œ ë¦¬ìŠ¤íŠ¸ (Local DB)</div>
                <div class="db-wrapper">
                    <div class="db-form-side">
                        <div class="form-group">
                            <label>ì¥ì†Œ ëª…ì¹­</label>
                            <input type="text" id="dbName" class="input-box" placeholder="ì‹ë‹¹ ë˜ëŠ” ì¥ì†Œ ì´ë¦„">
                        </div>
                        <div class="form-group" style="margin-top:10px;">
                            <label>íŠ¹ì§•/ë©”ëª¨</label>
                            <input type="text" id="dbMemo" class="input-box" placeholder="ì˜ˆ: ë£¸ 20ì„, ì£¼ì°¨í¸í•¨">
                        </div>
                        <button class="btn-add-db" onclick="saveToDB()">ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ê¸°</button>
                    </div>
                    <div class="db-list-side">
                        <table class="fav-table">
                            <thead>
                                <tr>
                                    <th>ì¥ì†Œëª…</th>
                                    <th>íŠ¹ì§•/ë©”ëª¨</th>
                                    <th>ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="dbBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card asset-section">
                <div class="card-title">ğŸ’» ì „ì‚° ê¸°ê¸° ìì‚° ëŒ€ì¥</div>
                <div class="file-upload-zone">
                    <input type="file" id="uploadFile" accept=".xlsx, .xls" />
                    <span style="font-size:14px; color:var(--text-sub);">ìì‚° ëª©ë¡ Excel ì—…ë¡œë“œ</span>
                </div>
                <div id="assetTable"></div>
            </div>
        </main>
    </div>

    <script>
        // ì‹œê³„ ë° ë‚ ì§œ ì—…ë°ì´íŠ¸
        function updateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('ko-KR', {year:'numeric', month:'long', day:'numeric', weekday:'short'});
            const timeStr = now.toLocaleTimeString('ko-KR', {hour12: false});
            document.getElementById('datePart').textContent = dateStr;
            document.getElementById('liveClock').textContent = timeStr;
        }
        updateTime();
        setInterval(updateTime, 1000);

        // íšŒì‹ ê²€ìƒ‰
        function searchDinner() {
            const area = document.getElementById('dinnerArea').value.trim();
            const people = document.getElementById('dinnerPeople').value;
            const type = document.getElementById('dinnerType').value;
            const needsRoom = document.getElementById('dinnerRoom').checked;
            if (!area) { alert("ì§€ì—­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."); return; }
            let query = `${area} ${type}`;
            if (needsRoom) query += " ë£¸ì‹ë‹¹";
            if (people) query += ` ${people}ëª…`;
            window.open(`https://map.naver.com/v5/search/${encodeURIComponent(query)}`, '_blank');
        }

        // í–‰ì‚¬ ê²€ìƒ‰
        function searchEvent() {
            const area = document.getElementById('eventArea').value.trim();
            const people = document.getElementById('eventPeople').value;
            const type = document.getElementById('eventType').value;
            if (!area) { alert("í–‰ì‚¬ ì˜ˆì • ì§€ì—­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”."); return; }
            let query = `${area} ${type}`;
            if (people) query += ` ${people}ëª…`;
            query = query.replace(/\s+/g, ' ').trim();
            window.open(`https://map.naver.com/v5/search/${encodeURIComponent(query)}`, '_blank');
        }

        // --- ë§›ì§‘/ì¥ì†Œ DB ë¡œì§ ---
        let favPlaces = JSON.parse(localStorage.getItem('hr_portal_favs')) || [];

        function renderDB() {
            const tbody = document.getElementById('dbBody');
            tbody.innerHTML = '';
            
            if (favPlaces.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align:center; color:#999; padding:20px;">ë“±ë¡ëœ ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤. ìì£¼ ê°€ëŠ” ê³³ì„ ë“±ë¡í•´ ë³´ì„¸ìš”!</td></tr>';
                return;
            }

            favPlaces.forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${item.name}</strong></td>
                    <td style="color:#666;">${item.memo}</td>
                    <td>
                        <button class="btn-mini btn-go" onclick="window.open('https://map.naver.com/v5/search/${encodeURIComponent(item.name)}', '_blank')">ì§€ë„ë³´ê¸°</button>
                        <button class="btn-mini btn-del" onclick="deleteItem(${index})">ì‚­ì œ</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function saveToDB() {
            const nameEl = document.getElementById('dbName');
            const memoEl = document.getElementById('dbMemo');
            
            if(!nameEl.value.trim()) { alert('ì¥ì†Œ ëª…ì¹­ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.'); return; }
            
            favPlaces.push({
                name: nameEl.value.trim(),
                memo: memoEl.value.trim()
            });
            
            localStorage.setItem('hr_portal_favs', JSON.stringify(favPlaces));
            nameEl.value = '';
            memoEl.value = '';
            renderDB();
        }

        function deleteItem(index) {
            if(confirm('ì´ ì¥ì†Œë¥¼ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œí• ê¹Œìš”?')) {
                favPlaces.splice(index, 1);
                localStorage.setItem('hr_portal_favs', JSON.stringify(favPlaces));
                renderDB();
            }
        }

        // ì´ˆê¸° ì‹¤í–‰
        renderDB();

        // ì—‘ì…€ ì—…ë¡œë“œ ë¡œì§
        document.getElementById('uploadFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(worksheet);
                let html = '<table><thead><tr>';
                if(json.length > 0) {
                    Object.keys(json[0]).forEach(key => html += `<th>${key}</th>`);
                    html += '</tr></thead><tbody>';
                    json.forEach(row => {
                        html += '<tr>';
                        Object.values(row).forEach(val => html += `<td>${val}</td>`);
                        html += '</tr>';
                    });
                }
                html += '</tbody></table>';
                document.getElementById('assetTable').innerHTML = html;
            };
            reader.readAsArrayBuffer(file);
        });
    </script>
</body>
</html>
