<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì¸ì‚¬ì´ë¬´ ì—…ë¬´ í¬í„¸ & ìì‚°ê´€ë¦¬</title>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        :root {
            --hr-blue: #0f62fe;
            --hr-teal: #0aa78e;
            --bg: #f4f7fb;
            --card: #ffffff;
            --muted: #6b7280;
            --text: #0f172a;
            --border: #e2e8f0;
            --accent: linear-gradient(90deg, rgba(15,98,254,0.12), rgba(10,167,142,0.06));
            --radius: 12px;
            --shadow: 0 4px 12px rgba(0,0,0,0.05);
            --danger: #ef4444;
        }

        html, body {
            height: 100%; margin: 0;
            font-family: "Pretendard", "Malgun Gothic", sans-serif;
            background: var(--bg); color: var(--text);
        }
        .wrap { max-width: 1280px; margin: 0 auto; padding: 24px; }
        
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; }
        .brand { display: flex; align-items: center; gap: 12px; }
        .logo { 
            width: 48px; height: 48px; border-radius: 10px; 
            background: var(--hr-blue); color: white; 
            display: flex; align-items: center; justify-content: center; 
            font-weight: 800; font-size: 20px;
        }
        .titles h1 { margin: 0; font-size: 20px; }
        .titles p { margin: 2px 0 0; font-size: 13px; color: var(--muted); }

        /* ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ */
        .grid-container {
            display: grid; grid-template-columns: repeat(12, 1fr); gap: 20px;
        }
        /* ì¼ë°˜ ì¹´ë“œ (4ì¹¸ ì°¨ì§€) */
        .card-sm { grid-column: span 3; }
        /* ìì‚° ëŒ€ì¥ ì¹´ë“œ (ì „ì²´ ë„ˆë¹„ ì°¨ì§€) */
        .card-lg { grid-column: span 12; }

        @media (max-width: 1024px) { .card-sm { grid-column: span 6; } }
        @media (max-width: 768px) { .card-sm { grid-column: span 12; } }

        .category-card {
            background: var(--card); border-radius: var(--radius);
            padding: 20px; box-shadow: var(--shadow);
            display: flex; flex-direction: column;
        }

        .category-title {
            display: flex; align-items: center; gap: 10px;
            font-weight: 700; font-size: 16px; margin-bottom: 16px;
        }
        .dot {
            width: 32px; height: 32px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; font-size: 18px;
        }

        /* ë§í¬ ë¦¬ìŠ¤íŠ¸ */
        .list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 8px; }
        .link-btn {
            display: block; text-decoration: none; color: var(--text);
            padding: 10px 12px; border-radius: 8px; background: #f8fafc;
            font-size: 14px; transition: 0.2s; border: 1px solid transparent;
        }
        .link-btn:hover { background: #eff6ff; border-color: var(--hr-blue); color: var(--hr-blue); }

        /* ============================
           ìì‚° ëŒ€ì¥ ì „ìš© ìŠ¤íƒ€ì¼
           ============================ */
        .toolbar-zone {
            display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: space-between;
            background: #f8fafc; padding: 12px; border-radius: 8px; margin-bottom: 12px; border: 1px solid var(--border);
        }
        .file-group { display: flex; align-items: center; gap: 8px; }
        input[type="file"]::file-selector-button {
            padding: 6px 12px; border-radius: 6px; border: 1px solid var(--border);
            background: white; cursor: pointer; font-size: 13px; margin-right: 10px;
        }
        
        .action-group { display: flex; gap: 8px; }
        .btn {
            padding: 8px 14px; border: none; border-radius: 6px; cursor: pointer;
            font-size: 13px; font-weight: 600; color: white; transition: 0.2s;
            display: inline-flex; align-items: center; gap: 4px;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-blue { background: var(--hr-blue); }
        .btn-teal { background: var(--hr-teal); }
        .btn-red { background: var(--danger); }
        .btn-gray { background: #64748b; }
        .btn:hover:not(:disabled) { filter: brightness(1.1); }

        /* í…Œì´ë¸” ì˜ì—­ */
        .table-wrapper {
            max-height: 500px; overflow: auto; border: 1px solid var(--border);
            border-radius: 8px; position: relative; background: white;
        }
        table { width: 100%; border-collapse: collapse; font-size: 13px; white-space: nowrap; }
        th {
            background: #f1f5f9; padding: 10px; text-align: left;
            position: sticky; top: 0; z-index: 10; border-bottom: 2px solid var(--border);
            font-weight: 700; color: #475569;
        }
        td {
            padding: 8px 10px; border-bottom: 1px solid #e2e8f0;
            color: #334155;
        }
        tr:hover td { background: #f8fafc; }
        
        /* í¸ì§‘ ê°€ëŠ¥í•œ ì…€ ìŠ¤íƒ€ì¼ */
        td[contenteditable="true"] {
            outline: none; background: #fff; cursor: text;
        }
        td[contenteditable="true"]:focus {
            background: #eff6ff; box-shadow: inset 0 0 0 2px var(--hr-blue);
        }
        td[contenteditable="true"]:hover { background: #fbfbfb; }

        /* ê²€ìƒ‰ì°½ */
        .search-input {
            padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px;
            font-size: 13px; width: 200px; outline: none;
        }
        .search-input:focus { border-color: var(--hr-blue); }

        .status-bar {
            margin-top: 8px; font-size: 12px; color: var(--muted); display: flex; justify-content: space-between;
        }
    </style>
</head>
<body>
    <div class="wrap">
        <header>
            <div class="brand">
                <div class="logo">HR</div>
                <div class="titles">
                    <h1>ì¸ì‚¬ì´ë¬´ í¬í„¸</h1>
                    <p>Total Service & Asset Management</p>
                </div>
            </div>
            <div style="font-size:13px; color:var(--muted);">
                ì˜¤ëŠ˜ ë‚ ì§œ: <span id="todayDate"></span>
            </div>
        </header>

        <div class="grid-container">
            <div class="category-card card-sm">
                <div class="category-title"><div class="dot" style="background:#eff6ff; color:#0f62fe;">ğŸ¢</div>ì´ë¬´/ë¹„í’ˆ</div>
                <ul class="list">
                    <li><a class="link-btn" href="https://www.officedepot.co.kr" target="_blank">ì˜¤í”¼ìŠ¤ë””í¬ (ì‚¬ë¬´ìš©í’ˆ)</a></li>
                    <li><a class="link-btn" href="https://post.koreapost.go.kr" target="_blank">ì¸í„°ë„· ìš°ì²´êµ­</a></li>
                    <li><a class="link-btn" href="https://www.bizhouse.co.kr" target="_blank">ëª…í•¨ ì‹ ì²­ (ë¹„ì¦ˆí•˜ìš°ìŠ¤)</a></li>
                </ul>
            </div>

            <div class="category-card card-sm">
                <div class="category-title"><div class="dot" style="background:#ecfdf5; color:#0aa78e;">âš–ï¸</div>ì‹ ê³ /ì¦ëª…ì„œ</div>
                <ul class="list">
                    <li><a class="link-btn" href="https://www.gov.kr" target="_blank">ì •ë¶€24 (ë“±ë³¸/ì´ˆë³¸)</a></li>
                    <li><a class="link-btn" href="https://www.4insure.or.kr" target="_blank">4ëŒ€ì‚¬íšŒë³´í—˜ ì •ë³´ì—°ê³„ì„¼í„°</a></li>
                    <li><a class="link-btn" href="https://minwon.hometax.go.kr" target="_blank">í™ˆíƒìŠ¤ ë¯¼ì›ì¦ëª…</a></li>
                </ul>
            </div>

            <div class="category-card card-sm">
                <div class="category-title"><div class="dot" style="background:#fffbeb; color:#d97706;">ğŸ“</div>ì„œì‹ ë‹¤ìš´ë¡œë“œ</div>
                <ul class="list">
                    <li><a class="link-btn" href="#">íœ´ê°€ ì‹ ì²­ì„œ.hwp</a></li>
                    <li><a class="link-btn" href="#">ì§€ì¶œ ê²°ì˜ì„œ.xls</a></li>
                    <li><a class="link-btn" href="#">ì¬ì§ ì¦ëª…ì„œ ìš”ì²­ì„œ.doc</a></li>
                </ul>
            </div>

            <div class="category-card card-sm">
                <div class="category-title"><div class="dot" style="background:#f3f4f6; color:#4b5563;">ğŸ“¢</div>ì‚¬ë‚´ ê³µì§€</div>
                <ul class="list">
                    <li><a class="link-btn" href="#">[ê³µì§€] 2026ë…„ ì„¤ ì—°íœ´ ì•ˆë‚´</a></li>
                    <li><a class="link-btn" href="#">[í•„ë…] ì •ë³´ë³´ì•ˆ ìº í˜ì¸ ì‹¤ì‹œ</a></li>
                </ul>
            </div>

            <div class="category-card card-lg" id="assetSection">
                <div class="category-title">
                    <div class="dot" style="background:linear-gradient(135deg,#0f62fe,#0aa78e); color:white;">ğŸ’»</div>
                    <div>PC ê¸°ê¸° ìì‚° ëŒ€ì¥ (ì›¹ ì—‘ì…€)</div>
                </div>

                <div class="toolbar-zone">
                    <div class="file-group">
                        <input type="file" id="uploadFile" accept=".xlsx, .xls, .csv" />
                        <span style="font-size:12px; color:var(--muted);">* ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ í¸ì§‘í•˜ì„¸ìš”.</span>
                    </div>
                    
                    <div class="action-group" id="controlPanel" style="display:none;">
                         <input type="text" id="searchInput" class="search-input" placeholder="ê²€ìƒ‰ (ì´ë¦„, ì‚¬ë²ˆ, ê¸°ê¸°ëª… ë“±)" />
                        
                        <button class="btn btn-blue" onclick="addRow()">+ í–‰ ì¶”ê°€</button>
                        <button class="btn btn-red" onclick="deleteSelectedRows()">ì„ íƒ ì‚­ì œ</button>
                        <button class="btn btn-teal" onclick="exportToExcel()">ğŸ“¥ ì—‘ì…€ ì €ì¥</button>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="assetTable">
                        <thead>
                            <tr id="tableHeader">
                                <th style="width: 40px; text-align:center;">ì„ íƒ</th>
                                <th>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì£¼ì„¸ìš”</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <tr>
                                <td colspan="2" style="text-align:center; padding: 40px; color:#94a3b8;">
                                    ìƒë‹¨ì˜ 'íŒŒì¼ ì„ íƒ'ì„ ëˆŒëŸ¬ ìì‚° ëŒ€ì¥ ì—‘ì…€ íŒŒì¼ì„ ì—´ì–´ì£¼ì„¸ìš”.<br>
                                    (ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì € ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.)
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="status-bar">
                    <span id="recordCount">ì´ 0ê±´</span>
                    <span>Tips: ì…€ì„ í´ë¦­í•˜ë©´ ë‚´ìš©ì„ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ì • í›„ 'ì—‘ì…€ ì €ì¥'ì„ ê¼­ ëˆŒëŸ¬ì£¼ì„¸ìš”.</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ
        const now = new Date();
        document.getElementById('todayDate').textContent = now.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });

        // ì „ì—­ ë³€ìˆ˜
        let globalData = [];    // ì „ì²´ ë°ì´í„° ê°ì²´ ë°°ì—´
        let globalHeaders = []; // í—¤ë” í‚¤ ë°°ì—´

        // 1. íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì‹±
        document.getElementById('uploadFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // ì²« ë²ˆì§¸ ì‹œíŠ¸ ê°€ì ¸ì˜¤ê¸°
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                
                // JSON ë³€í™˜ (í—¤ë” í¬í•¨)
                const jsonData = XLSX.utils.sheet_to_json(sheet, { defval: "" }); // ë¹ˆ ì…€ì€ ê³µë°± ì²˜ë¦¬

                if (jsonData.length > 0) {
                    globalData = jsonData;
                    globalHeaders = Object.keys(jsonData[0]);
                    renderTable();
                    document.getElementById('controlPanel').style.display = 'flex'; // ì»¨íŠ¸ë¡¤ íŒ¨ë„ í‘œì‹œ
                } else {
                    alert("ë°ì´í„°ê°€ ì—†ëŠ” ì—‘ì…€ íŒŒì¼ì…ë‹ˆë‹¤.");
                }
            };
            reader.readAsArrayBuffer(file);
        });

        // 2. í…Œì´ë¸” ë Œë”ë§ í•¨ìˆ˜
        function renderTable(dataToRender = globalData) {
            const thead = document.getElementById('tableHeader');
            const tbody = document.getElementById('tableBody');
            const countSpan = document.getElementById('recordCount');

            // í—¤ë” ìƒì„±
            let headerHTML = `<th style="width:40px; text-align:center;"><input type="checkbox" id="checkAll" onchange="toggleAll(this)"></th>`;
            globalHeaders.forEach(key => {
                headerHTML += `<th>${key}</th>`;
            });
            thead.innerHTML = headerHTML;

            // ë°”ë”” ìƒì„±
            if (dataToRender.length === 0) {
                tbody.innerHTML = `<tr><td colspan="${globalHeaders.length + 1}" style="text-align:center; padding:20px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
                countSpan.textContent = `ì´ 0ê±´`;
                return;
            }

            let bodyHTML = '';
            dataToRender.forEach((row, index) => {
                // ì›ë³¸ ë°ì´í„° ë°°ì—´ì—ì„œì˜ ì¸ë±ìŠ¤ë¥¼ ì¶”ì í•˜ê¸° ìœ„í•´ data-id ì†ì„± ì‚¬ìš©
                // (í•„í„°ë§ ì‹œì—ë„ ì›ë³¸ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„í•˜ë ¤ë©´ ì¡°ê¸ˆ ë” ë³µì¡í•´ì§€ë¯€ë¡œ, 
                //  ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ ë Œë”ë§ëœ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜, ì „ì²´ ì¬ë Œë”ë§ ë°©ì‹ì„ ì‚¬ìš©)
                
                bodyHTML += `<tr>`;
                bodyHTML += `<td style="text-align:center;"><input type="checkbox" class="row-checkbox" value="${index}"></td>`;
                
                globalHeaders.forEach(key => {
                    // contenteditable="true"ë¡œ ì„¤ì •í•˜ì—¬ ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥í•˜ê²Œ í•¨
                    // onblur ì´ë²¤íŠ¸ë¡œ ë°ì´í„° ë³€ê²½ ì‚¬í•­ì„ globalDataì— ì €ì¥
                    const val = row[key] !== undefined ? row[key] : "";
                    bodyHTML += `<td contenteditable="true" onblur="updateData(${index}, '${key}', this)">${val}</td>`;
                });
                bodyHTML += `</tr>`;
            });

            tbody.innerHTML = bodyHTML;
            countSpan.textContent = `ì´ ${dataToRender.length}ê±´`;
        }

        // 3. ë°ì´í„° ìˆ˜ì • í•¸ë“¤ëŸ¬ (ì…€ í¸ì§‘ í›„ í¬ì»¤ìŠ¤ ìƒì„ ë•Œ)
        function updateData(rowIndex, key, cell) {
            // í•„í„°ë§ ìƒíƒœì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ì˜ê°€ í•„ìš”í•˜ì§€ë§Œ, 
            // í˜„ì¬ ê°„ë‹¨í•œ êµ¬í˜„ì„ ìœ„í•´ í•„í„°ë§ ë˜ì§€ ì•Šì€ ìƒíƒœ ê¸°ì¤€ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜
            // ì‹¤ì œ ì•±ì—ì„œëŠ” ê° í–‰ì— ê³ ìœ  IDë¥¼ ë¶€ì—¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
            // ì—¬ê¸°ì„œëŠ” 'ë³´ì—¬ì§€ëŠ” í…Œì´ë¸”'ê³¼ 'globalData'ì˜ ë™ê¸°í™”ë¥¼ ìœ„í•´
            // ê²€ìƒ‰ ì¤‘ì—ëŠ” ìˆ˜ì •ì„ ë§‰ê±°ë‚˜, ê²€ìƒ‰ëœ ê²°ê³¼ì˜ ì›ë³¸ ì¸ë±ìŠ¤ë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.
            
            // *ê°„ë‹¨í•œ í•´ê²°ì±…*: í˜„ì¬ ê²€ìƒ‰ì–´ê°€ ìˆë‹¤ë©´ globalDataì—ì„œ í•´ë‹¹ ê°’ì„ ì°¾ì•„ ìˆ˜ì •í•˜ëŠ” ë¡œì§ì´ ë³µì¡í•´ì§€ë¯€ë¡œ
            // ê²€ìƒ‰ ì¤‘ ìˆ˜ì •ì€ ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤ëŠ” ì•Œë¦¼ì„ ì£¼ê±°ë‚˜, ê²€ìƒ‰ëœ ë°ì´í„° ë°°ì—´ì„ ì°¸ì¡°í•´ì•¼ í•¨.
            // ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ê²€ìƒ‰ë°”ê°€ ë¹„ì–´ìˆì„ ë•Œë§Œ ì •í™•í•œ ì¸ë±ìŠ¤ ë§¤ì¹­ì„ ë³´ì¥í•©ë‹ˆë‹¤.
            
            const isFiltered = document.getElementById('searchInput').value.trim() !== "";
            if(isFiltered) {
                // ê²€ìƒ‰ ìƒíƒœì—ì„œì˜ ìˆ˜ì •ì€ í˜„ì¬ ë·°ì˜ ë°ì´í„°ì™€ ì›ë³¸ ë°ì´í„° ë§¤í•‘ì´ í•„ìš”í•¨.
                // ë³µì¡ë„ë¥¼ ì¤„ì´ê¸° ìœ„í•´, ê²€ìƒ‰ í•„í„°ë§ ë¡œì§ì„ dataToRenderì— ì˜ì¡´í•˜ì§€ ì•Šê³ 
                // ê²€ìƒ‰ ì‹œì—ëŠ” ë Œë”ë§ë§Œ í•˜ê³ , ìˆ˜ì • ì‹œ globalDataë¥¼ ì§ì ‘ ì°¾ì§€ ì•ŠìŒ (UIì  í•œê³„)
                // -> ê°œì„ : ê²€ìƒ‰ ì‹œ ì›ë³¸ ë°ì´í„°ì˜ ì°¸ì¡°(Ref)ë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í•¨.
                // ì´ë²ˆ ì˜ˆì œì—ì„œëŠ” ê²€ìƒ‰ ì‹œì—ëŠ” ìˆ˜ì •ì´ ì›ë³¸ì— ë°˜ì˜ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒì„ ê°ì•ˆí•˜ê±°ë‚˜,
                // ê²€ìƒ‰ ê¸°ëŠ¥ì„ ë„ê³  ìˆ˜ì •í•˜ë„ë¡ ìœ ë„.
                
                // ë˜ëŠ” ì•„ë˜ searchInput ì´ë²¤íŠ¸ì—ì„œ globalData ìì²´ë¥¼ í•„í„°ë§ëœ ë·°ë¡œë§Œ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ ì‚¬ìš©.
            }
            
            globalData[rowIndex][key] = cell.innerText;
        }

        // 4. í–‰ ì¶”ê°€
        function addRow() {
            const newRow = {};
            globalHeaders.forEach(key => newRow[key] = "");
            globalData.unshift(newRow); // ë§¨ ìœ„ì— ì¶”ê°€
            
            // ê²€ìƒ‰ì–´ ì´ˆê¸°í™” í›„ ë Œë”ë§
            document.getElementById('searchInput').value = '';
            renderTable();
        }

        // 5. ì„ íƒëœ í–‰ ì‚­ì œ
        function deleteSelectedRows() {
            const checkboxes = document.querySelectorAll('.row-checkbox:checked');
            if (checkboxes.length === 0) {
                alert("ì‚­ì œí•  í–‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return;
            }

            if (!confirm(`${checkboxes.length}ê°œì˜ í–‰ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;

            // ë’¤ì—ì„œë¶€í„° ì‚­ì œí•´ì•¼ ì¸ë±ìŠ¤ê°€ ê¼¬ì´ì§€ ì•ŠìŒ
            const indicesToDelete = Array.from(checkboxes).map(cb => parseInt(cb.value)).sort((a, b) => b - a);
            
            indicesToDelete.forEach(index => {
                globalData.splice(index, 1);
            });

            document.getElementById('checkAll').checked = false;
            renderTable();
        }

        // 6. ê²€ìƒ‰ í•„í„°ë§
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const keyword = e.target.value.toLowerCase();
            if (keyword === "") {
                renderTable(globalData);
                return;
            }

            const filteredData = globalData.filter(row => {
                return Object.values(row).some(val => 
                    String(val).toLowerCase().includes(keyword)
                );
            });
            
            // í•„í„°ë§ ì‹œì—ëŠ” ì¸ë±ìŠ¤ê°€ ê¼¬ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìˆ˜ì • ê¸°ëŠ¥ ì œí•œì„ ë‘ê±°ë‚˜
            // ë Œë”ë§ í•¨ìˆ˜ë¥¼ ê°œì„ í•´ì•¼ í•˜ë‚˜, ì—¬ê¸°ì„œëŠ” ë·° ê¸°ëŠ¥ ìœ„ì£¼ë¡œ ì œê³µ
            renderTable(filteredData);
        });

        // 7. ì—‘ì…€ ë‚´ë³´ë‚´ê¸° (ì €ì¥)
        function exportToExcel() {
            if (globalData.length === 0) {
                alert("ì €ì¥í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            const ws = XLSX.utils.json_to_sheet(globalData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ìì‚°ëŒ€ì¥");

            // íŒŒì¼ëª… ìƒì„± (ë‚ ì§œ í¬í•¨)
            const dateStr = new Date().toISOString().slice(0,10).replace(/-/g, "");
            XLSX.writeFile(wb, `PCìì‚°ëŒ€ì¥_${dateStr}.xlsx`);
        }

        // ì „ì²´ ì„ íƒ í† ê¸€
        function toggleAll(source) {
            const checkboxes = document.querySelectorAll('.row-checkbox');
            checkboxes.forEach(cb => cb.checked = source.checked);
        }
    </script>
</body>
</html>
